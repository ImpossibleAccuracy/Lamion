(function(){"use strict";var t={989:function(t,e,n){var i=n(6198),o=(n(8975),n(9600),n(8862),n(1539),n(1703),n(2222),n(6754)),a=function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")},r=function(t){return t||(t={}),"GET"!==t.method&&(t.body=JSON.stringify(t.body)),t.method||(t.method="GET"),null==t.headers&&(t.headers={}),t.headers["Content-Type"]||(t.headers={"Content-Type":"application/json"}),t.headers.Authorization||(t.headers.Authorization=localStorage.getItem("token")),t},u=function(){var t=(0,i.Z)(regeneratorRuntime.mark((function t(e,n){var i,u,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=r(n),i="GET"===n.method?fetch.bind(null,o.Z.baseApiUrl+e+"?"+a(n.body),n):fetch.bind(null,o.Z.baseApiUrl+e,n),t.next=4,i();case 4:return u=t.sent,t.next=7,u.text();case 7:s=t.sent;try{s=JSON.parse(s)}catch(l){}if(!u.ok){t.next=13;break}return t.abrupt("return",s);case 13:throw c=new Error(s.details),c.ok=u.ok,c.status=u.status,c.statusText=u.statusText,c.redirected=u.redirected,c.url=u.url,c;case 20:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();e["Z"]={auth:{login:function(t,e){return u.call(this,"/login",{method:"POST",body:{email:t,password:e}})},register:function(t,e){return u.call(this,"/register",{method:"POST",body:{email:t,password:e}})}},user:{load:function(t){return u.call(this,"/user",{method:"GET",headers:{Authorization:t}})}},apps:{create:function(t){return u.call(this,"/application/",{method:"POST",body:t})},load:function(){return u.call(this,"/application")},count:function(){return u.call(this,"/application/count")},get:function(t){return u.call(this,"/application/".concat(t))},update:function(t,e){return u.call(this,"/application/".concat(t),{method:"PUT",body:e})},delete:function(t){return u.call(this,"/application/".concat(t),{method:"DELETE"})}},events:{create:function(t,e){return u.call(this,"/application/".concat(t,"/event"),{method:"POST",body:e})},load:function(t){return u.call(this,"/application/".concat(t,"/event"))},get:function(t,e){return u.call(this,"/application/".concat(t,"/event/").concat(e))},delete:function(t,e){return u.call(this,"/application/".concat(t,"/event/").concat(e),{method:"DELETE"})}},requests:{load:function(t,e){return u.call(this,"/application/".concat(t,"/event/").concat(e,"/request"))},loadAnalytics:function(t,e){return u.call(this,"/application/".concat(t,"/event/").concat(e,"/request/analytics"))}}}},6754:function(t,e){e["Z"]={applicationName:"Lamion",baseApiUrl:location.origin+"/api",user:{password:{minLength:6,maxLength:255}},app:{title:{maxLength:255},description:{maxLength:1024}},request:{title:{default:"Имя не указано"}},chart:{label:{maxLength:30}}}},9413:function(t,e,n){n(6992),n(8674),n(9601),n(7727);var i=n(8935),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("md-toolbar",{staticClass:"md-primary"},[n("div",{staticClass:"md-toolbar-section-start"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.showNavigation=!0}}},[n("md-icon",{attrs:{"md-font-set":"material-icons"}},[t._v("menu")])],1),n("h3",{staticClass:"md-title"},[t._v(t._s(t.title))])],1)]),n("md-drawer",{attrs:{"md-active":t.showNavigation},on:{"update:mdActive":function(e){t.showNavigation=e},"update:md-active":function(e){t.showNavigation=e}}},[null==t.user?n("md-list",[n("RouterLink",{attrs:{to:"/login",exact:""}},[n("md-list-item",{attrs:{href:"#"}},[n("span",{staticClass:"md-list-item-text"},[t._v("Войти")])])],1),n("RouterLink",{attrs:{to:"/register",exact:""}},[n("md-list-item",{attrs:{href:"#"}},[n("span",{staticClass:"md-list-item-text"},[t._v("Зарегистрироваться")])])],1),n("md-divider"),n("RouterLink",{attrs:{to:"/",exact:""}},[n("md-list-item",{attrs:{href:"#"}},[n("span",{staticClass:"md-list-item-text"},[t._v("На главную")])])],1)],1):n("md-list",[n("md-list-item",[n("span",{staticClass:"md-list-item-text"},[n("span",[t._v(t._s(t.user.email))]),n("span",{staticClass:"btn-logout md-primary",on:{click:t.showLogoutDialog}},[t._v("Выйти")])])]),n("md-divider"),n("RouterLink",{attrs:{to:"/",exact:""}},[n("md-list-item",{attrs:{href:"#"}},[n("span",{staticClass:"md-list-item-text"},[t._v("На главную")])])],1),n("RouterLink",{attrs:{to:"/apps",exact:""}},[n("md-list-item",{attrs:{href:"#"}},[n("span",{staticClass:"md-list-item-text"},[t._v("Приложения")])])],1),n("RouterLink",{attrs:{to:"/app/create",exact:""}},[n("md-list-item",{attrs:{href:"#"}},[n("span",{staticClass:"md-list-item-text"},[t._v("Создать приложение")])])],1)],1)],1),n("router-view",{staticClass:"article"}),n("md-dialog-alert",{attrs:{"md-title":"Error!","md-content":"An error occurred during automatic login.","md-active":t.dialogs.autoLoginFailed},on:{"update:mdActive":function(e){return t.$set(t.dialogs,"autoLoginFailed",e)},"update:md-active":function(e){return t.$set(t.dialogs,"autoLoginFailed",e)}}}),n("md-dialog-confirm",{attrs:{"md-title":"Выйти из Lamion?","md-confirm-text":"Продолжить","md-cancel-text":"Отмена","md-active":t.dialogs.logout},on:{"update:mdActive":function(e){return t.$set(t.dialogs,"logout",e)},"update:md-active":function(e){return t.$set(t.dialogs,"logout",e)},"md-confirm":t.logout}})],1)},a=[],r=n(6198),u=(n(8975),n(5822)),s=n.n(u),c=n(989),l=n(6754);i["default"].use(s());var d={name:"App",data:function(){return{showNavigation:!1,loginFailed:!1,dialogs:{autoLoginFailed:!1,logout:!1}}},computed:{user:function(){return this.$store.state.user},token:function(){return this.$store.state.token},title:function(){return this.$store.state.pageTitle},isLoggedIn:function(){return null!=this.user}},methods:{showLogoutDialog:function(){this.showNavigation=!1,this.dialogs.logout=!0},login:function(){var t=(0,r.Z)(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=this.$store.state.token,t.next=4,c.Z.user.load(e);case 4:n=t.sent,this.onAuthSuccess(n),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),this.onAuthFailed(t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));function e(){return t.apply(this,arguments)}return e}(),logout:function(){this.$store.commit("setUser",null),this.$store.commit("setToken",null),this.$router.go()},onAuthSuccess:function(t){console.log("Auto login: ".concat(t.email,".")),this.$store.commit("setUser",{id:t.id,email:t.email})},onAuthFailed:function(t){console.error("Auto login failed: ".concat(t)),this.$store.commit("setUser",null),window.localStorage.clear(),this.dialogs.autoLoginFailed=!0}},created:function(){var t=localStorage.getItem("token");this.$store.commit("setToken",t),null!==t&&this.login()},watch:{title:{immediate:!0,handler:function(t,e){document.title=t||l.Z.applicationName}},token:{immediate:!0,handler:function(t,e){"undefined"!==typeof e&&t!==e&&(null===t?localStorage.clear():localStorage.setItem("token",t))}}}},m=d,f=n(1001),p=(0,f.Z)(m,o,a,!1,null,null,null),h=p.exports,g=(n(1539),n(8783),n(3948),n(2809)),v=n(4665);i["default"].use(v.ZP);var b=new v.ZP.Store({state:{user:null,token:null,pageTitle:null},getters:{hasToken:function(t){var e=t.token;return"undefined"!==typeof e&&null!==e}},mutations:{setUser:function(t,e){t.user=e},setToken:function(t,e){t.token=e},setPageTitle:function(t,e){t.pageTitle=e}},actions:{},modules:{}});i["default"].use(g.Z);var y=[{path:"/",name:"Home",meta:{title:"Главная"},component:function(){return n.e(177).then(n.bind(n,4310))}},{path:"/login",name:"Login",meta:{title:"Войти",isAuthenticated:!1},component:function(){return n.e(535).then(n.bind(n,3007))}},{path:"/register",name:"Registration",meta:{title:"Зарегистрироваться",isAuthenticated:!1},component:function(){return n.e(535).then(n.bind(n,5469))}},{path:"/apps",name:"ApplicationsList",meta:{title:"Приложения",isAuthenticated:!0},component:function(){return n.e(535).then(n.bind(n,6328))}},{path:"/apps/:id",name:"ApplicationDetails",meta:{showTitle:!1,isAuthenticated:!0},component:function(){return n.e(535).then(n.bind(n,9397))}},{path:"/app/create",name:"ApplicationCreate",meta:{title:"Новое приложение",isAuthenticated:!0},component:function(){return n.e(535).then(n.bind(n,8336))}},{path:"/apps/:app_id/events/:id",name:"EventsDetails",meta:{showTitle:!1,isAuthenticated:!0},component:function(){return n.e(535).then(n.bind(n,2044))}},{path:"*",name:"PageNotFound",meta:{title:"Страница не найдена"},component:function(){return n.e(596).then(n.bind(n,3704))}}],w=new g.Z({base:"/",mode:"history",routes:y});w.beforeEach((function(t,e,n){"undefined"===typeof t.meta.isAuthenticated||null===t.meta.isAuthenticated||t.meta.isAuthenticated===(null!==localStorage.getItem("token"))?n():n({name:"Home",replace:!0})})),w.beforeEach((function(t,e,n){!1!==t.meta.showTitle&&b.commit("setPageTitle",t.meta.title),n()}));var k=w;i["default"].config.productionTip=!1,new i["default"]({router:k,store:b,render:function(t){return t(h)}}).$mount("#app")}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var a=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,function(){var t=[];n.O=function(e,i,o,a){if(!i){var r=1/0;for(l=0;l<t.length;l++){i=t[l][0],o=t[l][1],a=t[l][2];for(var u=!0,s=0;s<i.length;s++)(!1&a||r>=a)&&Object.keys(n.O).every((function(t){return n.O[t](i[s])}))?i.splice(s--,1):(u=!1,a<r&&(r=a));if(u){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}a=a||0;for(var l=t.length;l>0&&t[l-1][2]>a;l--)t[l]=t[l-1];t[l]=[i,o,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,i){return n.f[i](t,e),e}),[]))}}(),function(){n.u=function(t){return"js/"+{177:"home",535:"login",596:"404"}[t]+"-legacy."+{177:"e8e4f55a",535:"42223288",596:"a17f40ba"}[t]+".js"}}(),function(){n.miniCssF=function(t){return"css/"+{177:"home",535:"login"}[t]+"."+{177:"7bf66832",535:"3c06e16d"}[t]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="lamion:";n.l=function(i,o,a,r){if(t[i])t[i].push(o);else{var u,s;if(void 0!==a)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==e+a){u=d;break}}u||(s=!0,u=document.createElement("script"),u.charset="utf-8",u.timeout=120,n.nc&&u.setAttribute("nonce",n.nc),u.setAttribute("data-webpack",e+a),u.src=i),t[i]=[o];var m=function(e,n){u.onerror=u.onload=null,clearTimeout(f);var o=t[i];if(delete t[i],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((function(t){return t(n)})),e)return e(n)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=m.bind(null,u.onerror),u.onload=m.bind(null,u.onload),s&&document.head.appendChild(u)}}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){n.p="/"}(),function(){var t=function(t,e,n,i){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var a=function(a){if(o.onerror=o.onload=null,"load"===a.type)n();else{var r=a&&("load"===a.type?"missing":a.type),u=a&&a.target&&a.target.href||e,s=new Error("Loading CSS chunk "+t+" failed.\n("+u+")");s.code="CSS_CHUNK_LOAD_FAILED",s.type=r,s.request=u,o.parentNode.removeChild(o),i(s)}};return o.onerror=o.onload=a,o.href=e,document.head.appendChild(o),o},e=function(t,e){for(var n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var o=n[i],a=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(a===t||a===e))return o}var r=document.getElementsByTagName("style");for(i=0;i<r.length;i++){o=r[i],a=o.getAttribute("data-href");if(a===t||a===e)return o}},i=function(i){return new Promise((function(o,a){var r=n.miniCssF(i),u=n.p+r;if(e(r,u))return o();t(i,u,o,a)}))},o={143:0};n.f.miniCss=function(t,e){var n={177:1,535:1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=i(t).then((function(){o[t]=0}),(function(e){throw delete o[t],e})))}}(),function(){var t={143:0};n.f.j=function(e,i){var o=n.o(t,e)?t[e]:void 0;if(0!==o)if(o)i.push(o[2]);else{var a=new Promise((function(n,i){o=t[e]=[n,i]}));i.push(o[2]=a);var r=n.p+n.u(e),u=new Error,s=function(i){if(n.o(t,e)&&(o=t[e],0!==o&&(t[e]=void 0),o)){var a=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",u.name="ChunkLoadError",u.type=a,u.request=r,o[1](u)}};n.l(r,s,"chunk-"+e,e)}},n.O.j=function(e){return 0===t[e]};var e=function(e,i){var o,a,r=i[0],u=i[1],s=i[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(o in u)n.o(u,o)&&(n.m[o]=u[o]);if(s)var l=s(n)}for(e&&e(i);c<r.length;c++)a=r[c],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(l)},i=self["webpackChunklamion"]=self["webpackChunklamion"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(9413)}));i=n.O(i)})();
//# sourceMappingURL=app-legacy.35445573.js.map